<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ContentCrafter AI - Your Creative Assistant</title>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6a0dad;
            --secondary: #2d2d2d;
        }
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #fcfcfc;
        }
        .neub-border {
            border: 3px solid var(--secondary);
            box-shadow: 5px 5px 0px var(--secondary);
            transition: all 0.2s ease;
        }
        .neub-border:hover {
            transform: translate(2px, 2px);
            box-shadow: 3px 3px 0px var(--secondary);
        }
        .btn-primary {
            background-color: var(--primary);
            color: white;
            border: 3px solid var(--secondary);
        }
        .custom-scrollbar {
            scrollbar-width: thin;
            scrollbar-color: var(--primary) #ffffff;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #ffffff;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background-color: var(--primary);
            border-radius: 4px;
        }
        [x-cloak] { display: none !important; }
    </style>
</head>
<body x-data="contentCrafter()" x-init="init()" class="min-h-screen">
    <!-- Notification -->
    <div x-show="notification.show" x-cloak
         class="fixed bottom-4 right-4 bg-white neub-border p-4 z-50 max-w-sm">
        <p x-text="notification.message" class="text-secondary"></p>
    </div>

    <!-- Header -->
    <header class="bg-white border-b-3 border-secondary">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <img src="https://firebasestorage.googleapis.com/v0/b/widecanvas-d0dd4.appspot.com/o/logos%2Flogo.webp?alt=media&token=8b45193f-5cb6-4375-ba9a-c51b4480cb33" 
                         alt="Logo" 
                         class="h-10 w-auto neub-border p-1">
                    <h1 class="text-2xl font-bold">Content<span class="text-primary">Crafter</span></h1>
                </div>
                <button @click="showLibrary = true" class="neub-border bg-white px-4 py-2 hover:bg-gray-50">
                    <i class="bi bi-collection me-2"></i>My Library
                </button>
            </div>
        </nav>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Content Creation Form -->
        <div class="bg-white neub-border p-6 mb-8">
            <div class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <select x-model="currentTool" 
                            class="col-span-1 p-3 border-2 border-secondary focus:outline-none focus:border-primary">
                        <option value="ideas">Generate Ideas</option>
                        <option value="captions">Generate Captions</option>
                        <option value="images">Search Images</option>
                    </select>
                    <div class="col-span-2 flex gap-4">
                        <input type="text" 
                               x-model="query" 
                               @keyup.enter="generate"
                               class="flex-1 p-3 border-2 border-secondary focus:outline-none focus:border-primary"
                               :placeholder="getPlaceholder()">
                        <button @click="generate" 
                                class="neub-border btn-primary px-6 py-2 flex items-center justify-center min-w-[120px]"
                                :disabled="isLoading">
                            <span x-show="!isLoading">Generate</span>
                            <i x-show="isLoading" class="bi bi-arrow-repeat animate-spin"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <template x-for="(result, index) in results" :key="index">
                <div class="bg-white neub-border p-4 h-full">
                    <template x-if="currentTool === 'images'">
                        <img :src="result.url" :alt="result.alt" class="w-full h-48 object-cover mb-4 neub-border">
                    </template>
                    <template x-if="currentTool !== 'images'">
                        <p x-text="result.content" class="mb-4 text-secondary"></p>
                    </template>
                    <div class="flex justify-end space-x-2 mt-auto">
                        <button @click="copyToClipboard(result)" class="neub-border p-2 hover:bg-gray-50">
                            <i class="bi bi-clipboard"></i>
                        </button>
                        <button @click="saveItem(result)" class="neub-border p-2 hover:bg-gray-50">
                            <i class="bi bi-bookmark-plus"></i>
                        </button>
                    </div>
                </div>
            </template>
        </div>

        <!-- Library Modal -->
        <div x-show="showLibrary" x-cloak
             class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div @click.away="showLibrary = false" 
                 class="bg-white neub-border max-w-2xl w-full mx-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-secondary">My Library</h3>
                        <button @click="showLibrary = false" class="neub-border p-2 hover:bg-gray-50">
                            <i class="bi bi-x-lg"></i>
                        </button>
                    </div>
                    <div class="custom-scrollbar max-h-[60vh] overflow-y-auto space-y-4">
                        <template x-if="savedItems.length === 0">
                            <p class="text-center py-8 text-gray-500">Your library is empty. Start saving items!</p>
                        </template>
                        <template x-for="(item, index) in savedItems" :key="index">
                            <div class="neub-border p-4 bg-gray-50">
                                <template x-if="item.type === 'image'">
                                    <img :src="item.url" :alt="item.alt" class="w-full h-40 object-cover mb-2 neub-border">
                                </template>
                                <template x-if="item.type !== 'image'">
                                    <p x-text="item.content" class="text-secondary"></p>
                                </template>
                                <div class="flex justify-end mt-4">
                                    <button @click="removeItem(index)" class="neub-border p-2 text-red-500 hover:bg-red-50">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        function contentCrafter() {
            return {
                currentTool: 'ideas',
                query: '',
                results: [],
                savedItems: [],
                showLibrary: false,
                isLoading: false,
                notification: {
                    show: false,
                    message: ''
                },

                init() {
                    this.savedItems = JSON.parse(localStorage.getItem('savedItems') || '[]');
                },

                getPlaceholder() {
                    const placeholders = {
                        'ideas': 'Enter a topic to generate content ideas...',
                        'captions': 'Describe what you need captions for...',
                        'images': 'Enter keywords to search images...'
                    };
                    return placeholders[this.currentTool] || 'Enter your query...';
                },

                async generate() {
                    if (!this.query.trim()) return;
                    
                    this.isLoading = true;
                    try {
                        const response = await fetch('https://r0c8kgwocscg8gsokogwwsw4.zetaverse.one/ai', {
                            method: 'POST',
                            headers: {
                                'Authorization': 'Bearer Wz7vsrSK8uQfJlEHYlcFvUi6R2I3',
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                messages: [{
                                    role: 'user',
                                    content: [{ 
                                        type: 'text',
                                        text: `Generate 5 ${this.currentTool} for: ${this.query}`
                                    }]
                                }]
                            })
                        });
                        
                        const data = await response.json();
                        this.results = data.message.split('\n')
                            .filter(item => item.trim())
                            .map(item => ({
                                type: this.currentTool,
                                content: item
                            }));
                    } catch (error) {
                        console.error('Generation error:', error);
                        this.showNotification('Failed to generate content. Please try again.');
                    } finally {
                        this.isLoading = false;
                    }
                },
                async searchImages() {
                    const response = await fetch(`https://api.unsplash.com/photos/random?query=${encodeURIComponent(this.searchQuery)}&count=9&client_id=vRFxZ8hfjmOAfWKGcCE33ooXCcWmLVAF9P0GZ5phuvI`);
                    const data = await response.json();
                     this.results = data.map(image => ({
                        type: 'image',
                        url: image.urls.regular,
                        alt: image.alt_description,
                        attribution: image.user.name
                    }));
                },


                async copyToClipboard(item) {
                    const text = item.type === 'image' ? item.url : item.content;
                    try {
                        await navigator.clipboard.writeText(text);
                        this.showNotification('Copied to clipboard!');
                    } catch (error) {
                        this.showNotification('Failed to copy to clipboard');
                    }
                },

                saveItem(item) {
                    this.savedItems.push(item);
                    localStorage.setItem('savedItems', JSON.stringify(this.savedItems));
                    this.showNotification('Item saved to library!');
                },

                removeItem(index) {
                    this.savedItems.splice(index, 1);
                    localStorage.setItem('savedItems', JSON.stringify(this.savedItems));
                    this.showNotification('Item removed from library');
                },

                showNotification(message) {
                    this.notification.message = message;
                    this.notification.show = true;
                    setTimeout(() => {
                        this.notification.show = false;
                    }, 3000);
                }
            }
        }
    </script>
</body>
</html>
